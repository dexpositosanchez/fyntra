<div class="modulo-selector-container">
  <header class="selector-header">
    <div class="logo-section">
      <img src="/assets/images/Imagotipo.png" alt="Fyntra" class="logo-image" />
    </div>
    <button class="logout-button" (click)="logout()" title="Cerrar sesión" aria-label="Cerrar sesión">
      <span class="logout-icon app-icon">logout</span>
      <span class="logout-text">Salir</span>
    </button>
  </header>

  <main id="main-content" class="selector-main">
    <div class="welcome-section">
      <h1>Bienvenido, {{ usuario?.nombre }}</h1>
      <p>Selecciona el módulo al que deseas acceder</p>
    </div>

    <div class="modulos-grid">
      <div class="modulo-card" (click)="seleccionarModulo('fincas')">
        <div class="modulo-icon app-icon">apartment</div>
        <h2>Administración de Fincas</h2>
        <p>Gestión de comunidades, propietarios e incidencias</p>
        <div class="modulo-features">
          <span class="feature">Comunidades</span>
          <span class="feature">Incidencias</span>
          <span class="feature">Propietarios</span>
        </div>
      </div>

      <div class="modulo-card" (click)="seleccionarModulo('transportes')">
        <div class="modulo-icon app-icon">local_shipping</div>
        <h2>ERP de Transportes</h2>
        <p>Gestión de flota, rutas y pedidos</p>
        <div class="modulo-features">
          <span class="feature">Vehículos</span>
          <span class="feature">Rutas</span>
          <span class="feature">Pedidos</span>
        </div>
      </div>

      <div class="modulo-card sistema-card" *ngIf="usuario?.rol === 'super_admin'" (click)="irAUsuarios()">
        <div class="modulo-icon app-icon">people</div>
        <h2>Gestión de Usuarios</h2>
        <p>Administración de usuarios del sistema</p>
        <div class="modulo-features">
          <span class="feature">Crear</span>
          <span class="feature">Editar</span>
          <span class="feature">Roles</span>
        </div>
      </div>

      <div class="modulo-card" (click)="!exportando && exportarMisDatos(); $event.stopPropagation()" [class.disabled]="exportando" title="Descargar mis datos en JSON (RGPD)">
        <div class="modulo-icon app-icon">download</div>
        <h2>{{ exportando ? 'Exportando...' : 'Exportar mis datos' }}</h2>
        <p>Descargar mis datos personales en formato JSON (Art. 15 y 20 RGPD)</p>
        <div class="modulo-features">
          <span class="feature">Datos personales</span>
          <span class="feature">Portabilidad</span>
        </div>
      </div>

      <div class="modulo-card" (click)="!eliminando && eliminarMiCuenta(); $event.stopPropagation()" [class.disabled]="eliminando" title="Eliminar mi cuenta (derecho al olvido)">
        <div class="modulo-icon app-icon">person_off</div>
        <h2>{{ eliminando ? 'Eliminando...' : 'Eliminar mi cuenta' }}</h2>
        <p>Solicitar la eliminación de mi cuenta y datos personales (Art. 17 RGPD)</p>
        <div class="modulo-features">
          <span class="feature">Derecho al olvido</span>
          <span class="feature">Supresión</span>
        </div>
      </div>
    </div>

    <p *ngIf="mensajeRGPD" class="rgpd-feedback success">{{ mensajeRGPD }}</p>
    <p *ngIf="errorRGPD" class="rgpd-feedback error">{{ errorRGPD }}</p>
  </main>
</div>

